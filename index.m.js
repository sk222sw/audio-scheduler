var t;!function(t){t[t.Infinite=0]="Infinite",t[t.Finite=1]="Finite"}(t||(t={}));var i=function(){function i(i){this.initialIntervals=[],this.intervalList=[],this.mode=i.infinite?t.Infinite:t.Finite,this.initialIntervals=i.intervalLengths,this.scheduleAheadTime=i.schedulAheadTime||.1,this.intervalTime=i.intervalTime||50,this.tempo=i.tempo,this.context=i.context||new AudioContext}return i.prototype._init=function(){this.msTempo=6e4/this.tempo,this.intervalList=this.initialIntervals},i.prototype._intervalLengthInMs=function(){return this.msTempo/1e3},i.prototype.setTempo=function(t){this.tempo=t,this.msTempo=6e4/this.tempo},i.prototype._scheduler=function(i,e){if((n=this.intervalList)[n.length-1]){var n,s=this._calculateNext(function(t){return t[0]}(this.intervalList));s<i+this.scheduleAheadTime&&this._runCallback(s,e)}else this.mode===t.Finite?this.stopInterval(this.setIntervalReference):this.intervalList=this.initialIntervals},i.prototype._calculateNext=function(t){return(this.lastIntervalStartedAt||0)+t*this._intervalLengthInMs()},i.prototype._runCallback=function(t,i){this.intervalList=this.intervalList.slice(1,this.intervalList.length),this.lastIntervalStartedAt=t,i(t)},i.prototype.startInterval=function(t){var i=this;this._init(),this._runCallback(this.context.currentTime,t);var e=setInterval(function(e){return i._scheduler(i.context.currentTime,t)},this.intervalTime);return this.setIntervalReference=e,e},i.prototype.stopInterval=function(t){clearInterval(t)},i.prototype.updateIntervals=function(t){this.intervalList=t,this.initialIntervals=t},i.prototype.push=function(t){this.intervalList=this.intervalList.concat([t]),this.initialIntervals=this.initialIntervals.concat([t])},i.prototype.shift=function(){var t=this.intervalList,i=t.slice(1),e=this.initialIntervals,n=e.slice(1);this.intervalList=i,this.initialIntervals=n},i.prototype.pop=function(){var t=this.intervalList.slice();t.pop(),this.intervalList=t;var i=this.initialIntervals.slice();i.pop(),this.initialIntervals=i},i}();export{i as AudioScheduler};
//# sourceMappingURL=index.m.js.map
